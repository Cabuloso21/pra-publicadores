
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>testes detalhes</title>
</head>
<body>
  <h1>testes detalhes</h1>


  
  <style>
    .detalhes {
      padding: 20px;
      background-color: #f9f9f9;
      border-radius: 5px;
      margin: 20px;
    }
    h3 {
      margin-bottom: 15px;
    }
    input {
      display: block;
      margin: 10px 0;
      padding: 8px;
      width: 100%;
      box-sizing: border-box;
    }
    button {
      padding: 10px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<header>
  <div class="text">Meus estudantes</div>
</header>

<h2>Detalhes do Estudante</h2>
<div class="detalhes" id="detalhes-estudante">Carregando...</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import { getFirestore, doc, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCqkWODpY54YGrvqPVMABK_k_ZJLo1KXMA",
    authDomain: "teste-cfe69.firebaseapp.com",
    projectId: "teste-cfe69",
    storageBucket: "teste-cfe69.appspot.com",
    messagingSenderId: "646579509123",
    appId: "1:646579509123:web:dd23b863dd8c54bca308b6",
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const estudante = JSON.parse(localStorage.getItem('estudanteSelecionado')) || {};
  const detalhes = document.getElementById('detalhes-estudante');

  function exibirDetalhes() {
    if (estudante.nome) {
      detalhes.innerHTML = `
        <h3>${estudante.nome}</h3>
        <p><strong>Livro:</strong> ${estudante.livro}</p>
        <p><strong>Capítulo:</strong> ${estudante.capitulo}</p>
        <p><strong>Tema:</strong> ${estudante.tema}</p>
        <p><strong>Lição:</strong> ${estudante.licao}</p>
        <p><strong>WhatsApp:</strong> <a href="${estudante.whatsapp}" target="_blank">Conversar no WhatsApp</a></p>
        <button onclick="editarDetalhes()">Editar</button>
      `;
    } else {
      detalhes.textContent = "Nenhum estudante selecionado.";
    }
  }

  window.editarDetalhes = () => {
    detalhes.innerHTML = `
      <input type="text" id="nome" value="${estudante.nome || ''}" placeholder="Nome">
      <input type="text" id="livro" value="${estudante.livro || ''}" placeholder="Livro">
      <input type="text" id="capitulo" value="${estudante.capitulo || ''}" placeholder="Capítulo">
      <input type="text" id="tema" value="${estudante.tema || ''}" placeholder="Tema">
      <input type="text" id="licao" value="${estudante.licao || ''}" placeholder="Lição">
      <input type="text" id="whatsapp" value="${estudante.whatsapp || ''}" placeholder="Link do WhatsApp">
      <button onclick="salvarEdicao()">Salvar</button>
    `;
  };

  window.salvarEdicao = async () => {
    estudante.nome = document.getElementById('nome').value;
    estudante.livro = document.getElementById('livro').value;
    estudante.capitulo = document.getElementById('capitulo').value;
    estudante.tema = document.getElementById('tema').value;
    estudante.licao = document.getElementById('licao').value;
    estudante.whatsapp = document.getElementById('whatsapp').value;

    localStorage.setItem('estudanteSelecionado', JSON.stringify(estudante));

    if (estudante.id) {
      const ref = doc(db, "estudantes", estudante.id);
      try {
        await updateDoc(ref, {
          nome: estudante.nome,
          livro: estudante.livro,
          capitulo: estudante.capitulo,
          tema: estudante.tema,
          licao: estudante.licao,
          whatsapp: estudante.whatsapp
        });
        alert("Informações atualizadas com sucesso!");
      } catch (e) {
        console.error("Erro ao atualizar estudante:", e);
        alert("Erro ao salvar no banco de dados.");
      }
    }

    exibirDetalhes();
  };

  exibirDetalhes();
</script>
</body>
</html>


