<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>testando</title>
</head>
<body>
  <h1>testando</h1>


<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Alterar Email</title>
</head>
<body>
  <h2>Alterar E-mail</h2>
  <div id="emailChangeForm">
    <input type="email" id="newEmail" placeholder="Novo e-mail" /><br><br>
    <input type="password" id="currentPassword" placeholder="Senha atual" /><br><br>
    <button onclick="updateEmail()">Salvar</button>
  </div>
  <p id="mensagem"></p>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
    import { getAuth, EmailAuthProvider, reauthenticateWithCredential, updateEmail, sendEmailVerification } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCqkWODpY54YGrvqPVMABK_k_ZJLo1KXMA",
      authDomain: "teste-cfe69.firebaseapp.com",
      databaseURL: "https://teste-cfe69-default-rtdb.firebaseio.com",
      projectId: "teste-cfe69",
      storageBucket: "teste-cfe69.firebasestorage.app",
      messagingSenderId: "646579509123",
      appId: "1:646579509123:web:5565c595f322cf3ba308b6",
      measurementId: "G-81YQG8L41X"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    window.updateEmail = async function () {
      const user = auth.currentUser;
      const newEmail = document.getElementById("newEmail").value;
      const currentPassword = document.getElementById("currentPassword").value;
      const mensagem = document.getElementById("mensagem");

      if (!user) {
        mensagem.innerText = "Você precisa estar logado.";
        return;
      }

      const credential = EmailAuthProvider.credential(user.email, currentPassword);

      try {
        // Reautentica o usuário com a senha
        await reauthenticateWithCredential(user, credential);

        // Atualiza o email
        await updateEmail(user, newEmail);

        // Envia o link de verificação para o novo e-mail
        await sendEmailVerification(user);

        mensagem.innerText = "E-mail atualizado. Verifique sua nova caixa de entrada para confirmar.";
      } catch (error) {
        console.error(error);
        mensagem.innerText = `Erro: ${error.message}`;
      }
    };
  </script>
</body>
</html>




          
